<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>XRayCrypto ‚Äî Support</title>
  <meta name="description" content="If this project helps you, feel free to tip any amount. Thank you!"/>
  <link rel="icon" type="image/png" href="pfp.png" sizes="32x32"/>
  <link rel="stylesheet" href="styles.css"/>
  <style>
    /* ===== Page-only tweaks (scoped to .support-page) ===== */
    .support-page .support-wrap{display:grid; gap:16px; align-items:start;}
    .support-page .pfp-card{display:grid; place-items:center; padding:20px}

    /* Guard against any global img wideners after soft-nav */
    .support-page .pfp-card img.pfp{
      display:block;
      width:160px !important;
      height:160px !important;
      max-width:160px !important;
      max-height:160px !important;
      object-fit:cover;
      border-radius:20px;
      box-shadow:0 0 0 3px var(--accent);
    }

    .support-page .wallet-list{display:grid; gap:12px}
    .support-page .wallet-row{
      display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between;
      padding:12px; border:1px solid var(--border); border-radius:10px; background:var(--surface-2)
    }
    .support-page .wallet-row h3{margin:0; font-size:1rem}
    .support-page .addr-wrap{display:flex; gap:8px; align-items:center; flex:1; min-width:220px}
    .support-page .addr-wrap code{
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      padding:6px 8px; border:1px solid var(--border); border-radius:8px; background:var(--surface); max-width:100%
    }
    .support-page .button.small{padding:6px 10px; font-weight:700}

    /* Mobile wallet CTA */
    .support-page .mobile-wallet-cta{position:sticky; bottom:12px; display:block; margin-top:12px; text-align:center}
    .support-page #openWalletBtn{width:auto; min-width:170px;} /* <<< not full width */

    .support-page .wallet-sheet{
      position:fixed; inset:auto 12px 12px 12px; display:none;
      background:var(--surface); border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow); padding:12px;
      text-align:center;
    }
    .support-page .wallet-sheet h4{margin:0 0 8px}
    .support-page .wallet-sheet a{display:inline-flex; justify-content:center; margin:4px 6px; text-decoration:none}
    .support-page .wallet-sheet .button{width:auto}
    @media (max-width:640px){
      .support-page .mobile-wallet-cta{display:block}
    }
  </style>
</head>

<body class="support-page">
  <!-- HEADER -->
  <header class="header">
    <div class="topbar container">
      <a class="brand" href="index.html" data-softnav>
        <img src="pfp.png" alt="XRayCrypto logo" class="logo"/>
        <span class="name">XRayCrypto<span class="tm" aria-hidden="true">‚Ñ¢</span></span>
      </a>

      <button id="menuToggle" class="hamburger" aria-label="Open menu" aria-expanded="false" aria-controls="primaryNav">‚ò∞</button>

      <nav id="primaryNav" class="nav">
        <a href="index.html" data-softnav>Home</a>
        <a href="markets.html" data-softnav>Markets</a>
        <a href="watchlist.html" data-softnav>Watchlist</a>
        <a href="news.html" data-softnav>News</a>
        <a href="store.html" data-softnav>Store</a>
        <a href="chill.html" data-softnav>ChillZone</a>
        <a href="support.html" class="active" data-softnav>Support</a>
      </nav>

      <div id="headerControls" class="symbol-form">
        <button id="themeToggle" class="button outline" type="button" title="Toggle theme">üåô</button>
      </div>
    </div>

    <div class="ticker"><div id="cryptoTape"></div></div>
    <div class="ticker"><div id="stocksTape"></div></div>
  </header>

  <!-- MAIN -->
  <main class="main container" id="pageMain">
    <section class="section">
      <div class="support-wrap">
        <div class="card pfp-card">
          <!-- Added id + data-support-logo so main.js clampSupportLogo() always catches it -->
          <img src="pfp.png" alt="XRayCrypto avatar" class="pfp" id="supportLogo" data-support-logo loading="lazy">
          <p class="note" style="margin:10px 0 0">If this project helps you, a small tip keeps it fast and ad-free. Thank you! ‚ù§Ô∏è</p>
        </div>

        <div class="card">
          <h2 style="margin:0 0 10px">Tip Addresses</h2>
          <div class="wallet-list">

            <!-- BTC -->
            <div class="wallet-row">
              <h3>Bitcoin (BTC)</h3>
              <div class="addr-wrap" style="flex:1">
                <code id="addr-btc">bc1qlnldyzwzvu0wtej24kgk9c9tr7naz2fcdarrt6</code>
                <button class="button small" data-copy="#addr-btc">Copy</button>
              </div>
            </div>

            <!-- ETH -->
            <div class="wallet-row">
              <h3>Ethereum (ETH)</h3>
              <div class="addr-wrap" style="flex:1">
                <code id="addr-eth">0x26423bffa264bb913fb152401dbb63ff8176e6a3</code>
                <button class="button small" data-copy="#addr-eth">Copy</button>
              </div>
            </div>

            <!-- SOL -->
            <div class="wallet-row">
              <h3>Solana (SOL)</h3>
              <div class="addr-wrap" style="flex:1">
                <code id="addr-sol">6y6KMjsXoaWcUjz6pGty73gYTXtVahukCQdyk1vX6DLn</code>
                <button class="button small" data-copy="#addr-sol">Copy</button>
              </div>
            </div>

          </div>

          <!-- Mobile open-in-wallet CTA -->
          <div class="mobile-wallet-cta">
            <button id="openWalletBtn" class="button" type="button">Open in Wallet</button>
            <div id="walletSheet" class="wallet-sheet" role="dialog" aria-modal="true" aria-labelledby="wTitle">
              <h4 id="wTitle">Choose a network</h4>
              <a class="button outline" href="#" id="deeplink-btc">Open Bitcoin</a>
              <a class="button outline" href="#" id="deeplink-eth">Open Ethereum</a>
              <a class="button outline" href="#" id="deeplink-sol">Open Solana</a>
              <div style="display:flex; gap:8px; margin-top:8px; justify-content:center">
                <button id="sheetClose" class="button outline">Close</button>
              </div>
            </div>
          </div>

          <p class="note" style="margin-top:10px">
            Want human-readable? If your wallet supports UD, you can also tip <strong>xraymetax.online</strong>.
          </p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    ¬© 2025 XRayCrypto‚Ñ¢ ¬∑ <a href="https://x.com/xraycryptox" target="_blank" class="x-link">X</a>
  </footer>

  <script src="main.js"></script>
  <script>
    // Copy buttons
    document.addEventListener('click', async (e)=>{
      const btn = e.target.closest('[data-copy]');
      if(!btn) return;
      const sel = btn.getAttribute('data-copy');
      const el = document.querySelector(sel);
      if(!el) return;
      try{
        await navigator.clipboard.writeText(el.textContent.trim());
        btn.textContent = 'Copied!'; setTimeout(()=> btn.textContent='Copy', 1200);
      }catch{
        btn.textContent='Failed'; setTimeout(()=> btn.textContent='Copy', 1200);
      }
    });

    // Build deeplinks from visible addresses
    function setDeepLinks() {
      const btc = document.getElementById('addr-btc')?.textContent.trim();
      const eth = document.getElementById('addr-eth')?.textContent.trim();
      const sol = document.getElementById('addr-sol')?.textContent.trim();

      // BIP21: bitcoin:<addr>[?amount=...]
      const btcURL = new URL(`bitcoin:${encodeURIComponent(btc || '')}`);

      // ETH: ethereum:<addr>  (for amounts you could use EIP-681)
      const ethURL = `ethereum:${encodeURIComponent(eth || '')}`;

      // SOL: solana:<addr>
      const solURL = `solana:${encodeURIComponent(sol || '')}`;

      document.getElementById('deeplink-btc').href = btcURL.toString();
      document.getElementById('deeplink-eth').href = ethURL;
      document.getElementById('deeplink-sol').href = solURL;
    }

    // Helper: try to open a wallet app; if no handler, show a hint
    function tryOpen(url) {
      const timer = setTimeout(() => {
        if (!document.hidden) alert('No wallet app handled this link. Please open your wallet first or use Copy.');
      }, 1200);
      // cancel timer if the page becomes hidden (app took over)
      const cancel = () => { clearTimeout(timer); document.removeEventListener('visibilitychange', cancel); };
      document.addEventListener('visibilitychange', cancel, { once: true });

      window.location.href = url;
    }

    // Simple sheet for mobile ‚ÄúOpen in Wallet‚Äù
    const openBtn = document.getElementById('openWalletBtn');
    const sheet  = document.getElementById('walletSheet');
    const close  = document.getElementById('sheetClose');

    openBtn?.addEventListener('click', ()=>{ setDeepLinks(); sheet.style.display='block'; });
    close?.addEventListener('click', ()=>{ sheet.style.display='none'; });

    // Intercept deeplink clicks to use tryOpen()
    ['deeplink-btc','deeplink-eth','deeplink-sol'].forEach(id => {
      const a = document.getElementById(id);
      if (!a) return;
      a.addEventListener('click', (e) => {
        e.preventDefault();
        tryOpen(a.href);
      });
    });
  </script>
</body>
</html>
